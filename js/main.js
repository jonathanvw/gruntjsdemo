function findKeyframesRule(a){for(var b=document.styleSheets,c=0;c<b.length;++c)for(var d=0;d<b[c].cssRules.length;++d)if(b[c].cssRules[d].type===window.CSSRule.WEBKIT_KEYFRAMES_RULE&&b[c].cssRules[d].name===a)return b[c].cssRules[d];return null}function renderSlots(){var a=$(".cube-wrap").width(),b=.075;$(".cube-wrap").css({"-webkit-perspective":6*a+"px"}),$(".cube div").css("height",a+"px"),$(".cube-wrap.vertical .cube").each(function(){$(this).css({"-webkit-transform-origin":"0 "+.5*a+"px","-webkit-animation-name":"spin-vertical","-webkit-animation-duration":b+"s","-webkit-animation-iteration-count":"1","-webkit-animation-direction":"normal","-webkit-transform-style":"preserve-3d","-webkit-animation-fill-mode":"both","-webkit-animation-timing-function":"linear"})}),a*=.865,$(".depth div.first-pane").css({"-webkit-transform":"translateZ("+a+"px) rotateX(0deg)"}),$(".depth div.second-pane").css({"-webkit-transform":"rotateX(60deg) translateZ("+a+"px)"}),$(".depth div.third-pane").css({"-webkit-transform":"rotateX(120deg) translateZ("+a+"px)"}),$(".depth div.fourth-pane").css({"-webkit-transform":"translateZ("+-a+"px) rotateX(180deg)"}),$(".depth div.fifth-pane").css({"-webkit-transform":"rotateX(240deg) translateZ("+a+"px)"}),$(".depth div.sixth-pane").css({"-webkit-transform":"rotateX(300deg) translateZ("+a+"px)"})}function roll(){$(".cube").each(function(a){rotateFace($(this)),$(this).delay(300*a).queue(function(){$(this).addClass("running")})}),cheating===!0&&$shoots.animate({height:"100%"},600,function(){setTimeout(function(){$(".overlay").animate({bottom:"0%"},4e3,"easeInOutQuart",function(){$(".grunt").fadeIn("slow")})},800)})}function rotateFace(a){a.bind("webkitAnimationEnd",function(){startChange(a)})}function startChange(a){var b=Math.floor(10*Math.random()+1);a.css("-webkit-animation-name","none"),setTimeout(function(){change("spin-vertical",a,b)},0)}function change(a,b,c){keyframes.insertRule("0% { -webkit-transform: rotateX("+rotDeg+"deg); }"),keyframes.insertRule("100% { -webkit-transform: rotateX("+(rotDeg+60)+"deg); }"),b.css("webkit-animation-name",a),rotDeg-=60,sabotage===!0?(rotDeg=60,b.removeClass("running"),stopRotate(b)):cheating===!0?(rotDeg=60,b.removeClass("running"),stopRotate(b)):-360-60*c>=rotDeg&&(rotDeg+=780,b.removeClass("running"),stopRotate(b))}function stopRotate(a){a.unbind("webkitAnimationEnd")}function animateBall(a,b,c){count!==a&&($(".lever-ball").removeClass().addClass("lever-ball").addClass("ball-"+count),count+=b,setTimeout(function(){animateBall(a,b,c)},c))}function fixer(){try{(sabotage===!0||$outerWrapper.hasClass("troll"))&&(sabotage=!1,$outerWrapper.removeClass("troll"))}catch(a){console.log(a)}}var keyframes=findKeyframesRule("spin-vertical"),count=0,rotDeg=60,cheating=!1,sabotage=!1,cheatingCode=0,failingCode=0,$shoots=$(".coin-shoot").add(".coin-shoot:before"),$coin=$(".coin"),$outerWrapper=$(".outer-wrapper");$(document).ready(function(){fixer(),renderSlots(),roll(),$(window).resize(function(){renderSlots()}),$(".lever-ball").click(function(){return $(".coin").hasClass("inserted")?(fixer(),3===cheatingCode?cheating=!0:(3===failingCode||sabotage===!0||$outerWrapper.hasClass("troll"))&&(sabotage=!0,$outerWrapper.addClass("troll")),$(".coin").hide().removeClass("inserted").delay(2e3).fadeIn("fast").addClass("sway"),animateBall(9,1,120),$(".lever-ball").animate({textIndent:0},{step:function(){$(this).css("-moz-transform","rotateX(70deg)"),$(this).css("-webkit-transform","rotateX(70deg)"),$(this).css("-o-transform","rotateX(70deg)"),$(this).css("transform","rotateX(70deg)")},duration:1500,complete:function(){$(".led-box").removeClass("readyState").addClass("pulse"),roll()}}),$(".lever-wrapper").animate({textIndent:0},{step:function(){$(this).css("-moz-transform","rotateX(-70deg)"),$(this).css("-webkit-transform","rotateX(-70deg)"),$(this).css("-o-transform","rotateX(-70deg)"),$(this).css("transform","rotateX(-70deg)")},duration:1500,complete:function(){$(".cube").addClass("running"),animateBall(0,-1,90)}}),$(".lever-ball").add(".lever-wrapper").animate({textIndent:0},{step:function(){$(this).css("-moz-transform","rotateX(0deg)"),$(this).css("-webkit-transform","rotateX(0deg)"),$(this).css("-o-transform","rotateX(0deg)"),$(this).css("transform","rotateX(0deg)")},duration:1500,complete:function(){cheating=!1,sabotage=!1,cheatingCode=0,failingCode=0}}),void 0):($(".led-box").removeClass("pulse").addClass("errorState"),setTimeout(function(){$(".led-box").removeClass("errorState").addClass("pulse")},1500),failingCode++,void 0)}),$coin.hover(function(){$(this).hasClass("inserted")||$(this).removeClass("sway")},function(){$(this).hasClass("inserted")||$(this).addClass("sway")}).click(function(){$(this).addClass("inserted"),$(".led-box").removeClass("pulse").addClass("readyState"),cheatingCode++})});